/*
	--------------------------------
	Infinite Scroll
	--------------------------------
	+ https://github.com/paulirish/infinitescroll
	+ version 2.0b2.110713
	+ Copyright 2011 Paul Irish & Luke Shumard
	+ Licensed under the MIT license
	
	+ Documentation: http://infinite-scroll.com/
	
*/
!function(window,$,undefined){$.infinitescroll=function(options,callback,element){this.element=$(element),this._create(options,callback)},$.infinitescroll.defaults={loading:{finished:undefined,finishedMsg:"<em>Congratulations, you've reached the end of the internet.</em>",img:"http://www.infinite-scroll.com/loading.gif",msg:null,msgText:"<em>Loading the next set of posts...</em>",selector:null,speed:"fast",start:undefined},state:{isDuringAjax:!1,isInvalidPage:!1,isDestroyed:!1,isDone:!1,isPaused:!1,currPage:1},callback:undefined,debug:!1,behavior:undefined,binder:$(window),nextSelector:"div.navigation a:first",navSelector:"div.navigation",contentSelector:null,extraScrollPx:150,itemSelector:"div.post",animate:!1,pathParse:undefined,dataType:"html",appendCallback:!0,bufferPx:40,errorCallback:function(){},infid:0,pixelsFromNavToBottom:undefined,path:undefined},$.infinitescroll.prototype={_binding:function(binding){var instance=this,opts=instance.options;return opts.behavior&&this["_binding_"+opts.behavior]!==undefined?(this["_binding_"+opts.behavior].call(this),void 0):"bind"!==binding&&"unbind"!==binding?(this._debug("Binding value  "+binding+" not valid"),!1):("unbind"==binding?this.options.binder.unbind("smartscroll.infscr."+instance.options.infid):this.options.binder[binding]("smartscroll.infscr."+instance.options.infid,function(){instance.scroll()}),this._debug("Binding",binding),void 0)},_create:function(options,callback){if(!this._validate(options))return!1;var opts=this.options=$.extend(!0,{},$.infinitescroll.defaults,options),path=$(opts.nextSelector).attr("href");return opts.contentSelector=opts.contentSelector||this.element,opts.loading.selector=opts.loading.selector||opts.contentSelector,path?(opts.path=this._determinepath(path),opts.loading.msg=$('<div id="infscr-loading"><img alt="Loading..." src="'+opts.loading.img+'" /><div>'+opts.loading.msgText+"</div></div>"),(new Image).src=opts.loading.img,opts.pixelsFromNavToBottom=$(document).height()-$(opts.navSelector).offset().top,opts.loading.start=opts.loading.start||function(){$(opts.navSelector).hide(),opts.loading.msg.appendTo(opts.loading.selector).show(opts.loading.speed,function(){beginAjax(opts)})},opts.loading.finished=opts.loading.finished||function(){opts.loading.msg.fadeOut("normal")},opts.callback=function(instance,data){opts.behavior&&instance["_callback_"+opts.behavior]!==undefined&&instance["_callback_"+opts.behavior].call($(opts.contentSelector)[0],data),callback&&callback.call($(opts.contentSelector)[0],data)},this._setup(),void 0):(this._debug("Navigation selector not found"),void 0)},_debug:function(){return this.options.debug?window.console&&console.log.call(console,arguments):void 0},_determinepath:function(path){var opts=this.options;if(opts.behavior&&this["_determinepath_"+opts.behavior]!==undefined)return this["_determinepath_"+opts.behavior].call(this,path),void 0;if(opts.pathParse)return this._debug("pathParse manual"),opts.pathParse;if(path.match(/^(.*?)\b2\b(.*?$)/))path=path.match(/^(.*?)\b2\b(.*?$)/).slice(1);else if(path.match(/^(.*?)2(.*?$)/)){if(path.match(/^(.*?page=)2(\/.*|$)/))return path=path.match(/^(.*?page=)2(\/.*|$)/).slice(1);path=path.match(/^(.*?)2(.*?$)/).slice(1)}else{if(path.match(/^(.*?page=)1(\/.*|$)/))return path=path.match(/^(.*?page=)1(\/.*|$)/).slice(1);this._debug("Sorry, we couldn't parse your Next (Previous Posts) URL. Verify your the css selector points to the correct A tag. If you still get this error: yell, scream, and kindly ask for help at infinite-scroll.com."),opts.state.isInvalidPage=!0}return this._debug("determinePath",path),path},_error:function(xhr){var opts=this.options;return opts.behavior&&this["_error_"+opts.behavior]!==undefined?(this["_error_"+opts.behavior].call(this,xhr),void 0):("destroy"!==xhr&&"end"!==xhr&&(xhr="unknown"),this._debug("Error",xhr),"end"==xhr&&this._showdonemsg(),opts.state.isDone=!0,opts.state.currPage=1,opts.state.isPaused=!1,this._binding("unbind"),void 0)},_loadcallback:function(box,data){var frag,opts=this.options,callback=this.options.callback,result=opts.state.isDone?"done":opts.appendCallback?"append":"no-append";if(opts.behavior&&this["_loadcallback_"+opts.behavior]!==undefined)return this["_loadcallback_"+opts.behavior].call(this,box,data),void 0;switch(result){case"done":return this._showdonemsg(),!1;case"no-append":"html"==opts.dataType&&(data="<div>"+data+"</div>",data=$(data).find(opts.itemSelector));break;case"append":var children=box.children();if(0==children.length)return this._error("end");for(frag=document.createDocumentFragment();box[0].firstChild;)frag.appendChild(box[0].firstChild);this._debug("contentSelector",$(opts.contentSelector)[0]),$(opts.contentSelector)[0].appendChild(frag),data=children.get()}if(opts.loading.finished.call($(opts.contentSelector)[0],opts),opts.animate){var scrollTo=$(window).scrollTop()+$("#infscr-loading").height()+opts.extraScrollPx+"px";$("html,body").animate({scrollTop:scrollTo},800,function(){opts.state.isDuringAjax=!1})}opts.animate||(opts.state.isDuringAjax=!1),callback(this,data)},_nearbottom:function(){var opts=this.options,pixelsFromWindowBottomToBottom=0+$(document).height()-opts.binder.scrollTop()-$(window).height();return opts.behavior&&this["_nearbottom_"+opts.behavior]!==undefined?(this["_nearbottom_"+opts.behavior].call(this),void 0):(this._debug("math:",pixelsFromWindowBottomToBottom,opts.pixelsFromNavToBottom),pixelsFromWindowBottomToBottom-opts.bufferPx<opts.pixelsFromNavToBottom)},_pausing:function(pause){var opts=this.options;if(opts.behavior&&this["_pausing_"+opts.behavior]!==undefined)return this["_pausing_"+opts.behavior].call(this,pause),void 0;switch("pause"!==pause&&"resume"!==pause&&null!==pause&&this._debug("Invalid argument. Toggling pause value instead"),pause=!pause||"pause"!=pause&&"resume"!=pause?"toggle":pause){case"pause":opts.state.isPaused=!0;break;case"resume":opts.state.isPaused=!1;break;case"toggle":opts.state.isPaused=!opts.state.isPaused}return this._debug("Paused",opts.state.isPaused),!1},_setup:function(){var opts=this.options;return opts.behavior&&this["_setup_"+opts.behavior]!==undefined?(this["_setup_"+opts.behavior].call(this),void 0):(this._binding("bind"),!1)},_showdonemsg:function(){var opts=this.options;return opts.behavior&&this["_showdonemsg_"+opts.behavior]!==undefined?(this["_showdonemsg_"+opts.behavior].call(this),void 0):(opts.loading.msg.find("img").hide().parent().find("div").html(opts.loading.finishedMsg).animate({opacity:1},2e3,function(){$(this).parent().fadeOut("normal")}),opts.errorCallback.call($(opts.contentSelector)[0],"done"),void 0)},_validate:function(opts){for(var key in opts)return key.indexOf&&key.indexOf("Selector")>-1&&0===$(opts[key]).length?(this._debug("Your "+key+" found no elements."),!1):!0},bind:function(){this._binding("bind")},destroy:function(){return this.options.state.isDestroyed=!0,this._error("destroy")},pause:function(){this._pausing("pause")},resume:function(){this._pausing("resume")},retrieve:function(pageNum){var box,desturl,method,condition,instance=this,opts=instance.options,path=opts.path,pageNum=pageNum||null;return pageNum?pageNum:opts.state.currPage,beginAjax=function(opts){switch(opts.state.currPage++,instance._debug("heading into ajax",path),box=$(opts.contentSelector).is("table")?$("<tbody/>"):$("<div/>"),desturl=path.join(opts.state.currPage),method="html"==opts.dataType||"json"==opts.dataType?opts.dataType:"html+callback",opts.appendCallback&&"html"==opts.dataType&&(method+="+callback"),method){case"html+callback":instance._debug("Using HTML via .load() method"),box.load(desturl+" "+opts.itemSelector,null,function(responseText){instance._loadcallback(box,responseText)});break;case"html":case"json":instance._debug("Using "+method.toUpperCase()+" via $.ajax() method"),$.ajax({url:desturl,dataType:opts.dataType,complete:function(jqXHR,textStatus){condition="undefined"!=typeof jqXHR.isResolved?jqXHR.isResolved():"success"===textStatus||"notmodified"===textStatus,condition?instance._loadcallback(box,jqXHR.responseText):instance._error("end")}})}},opts.behavior&&this["retrieve_"+opts.behavior]!==undefined?(this["retrieve_"+opts.behavior].call(this,pageNum),void 0):opts.state.isDestroyed?(this._debug("Instance is destroyed"),!1):(opts.state.isDuringAjax=!0,opts.loading.start.call($(opts.contentSelector)[0],opts),void 0)},scroll:function(){var opts=this.options,state=opts.state;return opts.behavior&&this["scroll_"+opts.behavior]!==undefined?(this["scroll_"+opts.behavior].call(this),void 0):(state.isDuringAjax||state.isInvalidPage||state.isDone||state.isDestroyed||state.isPaused||this._nearbottom()&&this.retrieve(),void 0)},toggle:function(){this._pausing()},unbind:function(){this._binding("unbind")},update:function(key){$.isPlainObject(key)&&(this.options=$.extend(!0,this.options,key))}},$.fn.infinitescroll=function(options,callback){var thisCall=typeof options;switch(thisCall){case"string":var args=Array.prototype.slice.call(arguments,1);this.each(function(){var instance=$.data(this,"infinitescroll");return instance?$.isFunction(instance[options])&&"_"!==options.charAt(0)?(instance[options].apply(instance,args),void 0):!1:!1});break;case"object":this.each(function(){var instance=$.data(this,"infinitescroll");instance?instance.update(options):$.data(this,"infinitescroll",new $.infinitescroll(options,callback,this))})}return this};var scrollTimeout,event=$.event;event.special.smartscroll={setup:function(){$(this).bind("scroll",event.special.smartscroll.handler)},teardown:function(){$(this).unbind("scroll",event.special.smartscroll.handler)},handler:function(event,execAsap){var context=this,args=arguments;event.type="smartscroll",scrollTimeout&&clearTimeout(scrollTimeout),scrollTimeout=setTimeout(function(){$.event.handle.apply(context,args)},"execAsap"===execAsap?0:100)}},$.fn.smartscroll=function(fn){return fn?this.bind("smartscroll",fn):this.trigger("smartscroll",["execAsap"])}}(window,jQuery);